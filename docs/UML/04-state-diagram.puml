@startuml Estados de Solicitud de Asesor√≠a
!theme plain
skinparam backgroundColor white
skinparam stateBackgroundColor lightblue
skinparam stateBorderColor navy

title Estados del Flujo de Solicitudes de Asesor√≠a

[*] --> PENDING : Estudiante crea\nsolicitud

state PENDING {
  state PENDING : üìã Solicitud Pendiente
  state PENDING : ‚Ä¢ Esperando revisi√≥n del profesor
  state PENDING : ‚Ä¢ Notificaci√≥n enviada al profesor
  state PENDING : ‚Ä¢ Estudiante puede cancelar
}

state APPROVED {
  state APPROVED : ‚úÖ Solicitud Aprobada
  state APPROVED : ‚Ä¢ Sesi√≥n de asesor√≠a creada
  state APPROVED : ‚Ä¢ Estudiante notificado
  state APPROVED : ‚Ä¢ Fecha y hora confirmadas
}

state REJECTED {
  state REJECTED : ‚ùå Solicitud Rechazada
  state REJECTED : ‚Ä¢ Motivo del rechazo registrado
  state REJECTED : ‚Ä¢ Estudiante notificado
  state REJECTED : ‚Ä¢ No se crea sesi√≥n
}

state CANCELLED {
  state CANCELLED : üö´ Solicitud Cancelada
  state CANCELLED : ‚Ä¢ Cancelada por estudiante o profesor
  state CANCELLED : ‚Ä¢ Motivo de cancelaci√≥n registrado
  state CANCELLED : ‚Ä¢ Ambas partes notificadas
}

state COMPLETED {
  state COMPLETED : üéì Sesi√≥n Completada
  state COMPLETED : ‚Ä¢ Asistencia registrada
  state COMPLETED : ‚Ä¢ Notas de la sesi√≥n guardadas
  state COMPLETED : ‚Ä¢ Seguimiento enviado por email
}

' Transiciones principales
PENDING --> APPROVED : Profesor aprueba\n[con mensaje opcional]
PENDING --> REJECTED : Profesor rechaza\n[con motivo]
PENDING --> CANCELLED : Estudiante cancela\n[antes de aprobaci√≥n]

' Transiciones desde APPROVED
APPROVED --> COMPLETED : Profesor registra\nasistencia y completa
APPROVED --> CANCELLED : Profesor o estudiante\ncancela [con motivo]

' Estados finales
REJECTED --> [*] : Proceso terminado
CANCELLED --> [*] : Proceso terminado  
COMPLETED --> [*] : Proceso terminado

' Notas y validaciones
note right of PENDING : Timeout autom√°tico:\nSi no hay respuesta en 7 d√≠as,\nse marca como EXPIRED

note right of APPROVED : Recordatorios autom√°ticos:\n‚Ä¢ 24 horas antes de la sesi√≥n\n‚Ä¢ 1 hora antes de la sesi√≥n

note right of COMPLETED : M√©tricas registradas:\n‚Ä¢ Duraci√≥n real de la sesi√≥n\n‚Ä¢ Rating de satisfacci√≥n\n‚Ä¢ Temas cubiertos

' Auto-transiciones especiales
PENDING : entry / enviarNotificacionProfesor()
PENDING : after 7 days / marcarComoExpirada()

APPROVED : entry / crearSesionAsesoria()
APPROVED : entry / enviarConfirmacionEstudiante()
APPROVED : 24 hours before / enviarRecordatorio()

COMPLETED : entry / calcularMetricas()
COMPLETED : entry / enviarSeguimiento()

state "Estados de Sesi√≥n Relacionados" as SessionStates {
  state SCHEDULED : üìÖ Sesi√≥n Programada
  state IN_PROGRESS : ‚è≥ Sesi√≥n en Curso
  state SESSION_COMPLETED : ‚úÖ Sesi√≥n Finalizada
  
  APPROVED --> SCHEDULED : Autom√°tico al\naprobar solicitud
  SCHEDULED --> IN_PROGRESS : Profesor inicia\nsesi√≥n
  IN_PROGRESS --> SESSION_COMPLETED : Profesor registra\nasistencia
  SESSION_COMPLETED --> COMPLETED : Actualizaci√≥n de\nestado de solicitud
}

@enduml